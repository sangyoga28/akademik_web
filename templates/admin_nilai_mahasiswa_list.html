{% extends "base.html" %}

{% block title %}Input Nilai Per Mahasiswa - Admin{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-12">
        <h2 class="fw-bold text-primary"><i class="bi bi-pencil-square me-2"></i> Input Nilai (Per Mahasiswa)</h2>
        <p class="text-muted">Pilih mahasiswa untuk menginput nilai KHS mereka secara massal.</p>
    </div>
</div>

<div class="card border-0 shadow-sm rounded-4 mb-4">
    <div class="card-body bg-light rounded-4">
        <form method="GET" action="{{ url_for('admin.admin_nilai_mahasiswa_list') }}" class="row g-3 align-items-end">
            <div class="col-md-4">
                <label class="form-label fw-bold small text-uppercase text-muted">Program Studi</label>
                <select name="prodi" class="form-select border-0 shadow-sm">
                    <option value="">-- Semua Program Studi --</option>
                    {% for p in daftar_prodi %}
                    <option value="{{ p }}" {% if prodi==p %}selected{% endif %}>{{ p }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label fw-bold small text-uppercase text-muted">Semester (Target Input)</label>
                <select name="semester" class="form-select border-0 shadow-sm">
                    {% for i in range(1, 9) %}
                    <option value="{{ i }}" {% if semester==i %}selected{% endif %}>Semester {{ i }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label fw-bold small text-uppercase text-muted">Tahun Ajaran</label>
                <select name="tahun_ajaran" class="form-select border-0 shadow-sm">
                    <option value="2023/2024" {% if tahun_ajaran=='2023/2024' %}selected{% endif %}>2023/2024</option>
                    <option value="2024/2025" {% if tahun_ajaran=='2024/2025' %}selected{% endif %}>2024/2025</option>
                </select>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100 fw-bold shadow-sm">
                    <i class="bi bi-search"></i> Cari
                </button>
            </div>
        </form>
    </div>
</div>

<div class="card border-0 shadow-sm rounded-4 overflow-hidden">
    <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
            <thead class="bg-primary text-white">
                <tr>
                    <th class="ps-4 py-3">NIM</th>
                    <th class="py-3">Nama Mahasiswa</th>
                    <th class="py-3">Prodi</th>
                    <th class="py-3 text-center">Aksi</th>
                </tr>
            </thead>
            <tbody>
                {% for m in mahasiswa_list %}
                <tr>
                    <td class="ps-4 fw-bold font-monospace">{{ m['nim'] }}</td>
                    <td>{{ m['nama'] }}</td>
                    <td>{{ m['prodi'] }}</td>
                    <td class="text-center">
                        <a href="{{ url_for('admin.input_nilai_mahasiswa', nim=m['nim'], semester=semester, tahun_ajaran=tahun_ajaran) }}"
                            class="btn btn-sm btn-outline-primary rounded-pill px-4 fw-bold">
                            Input Nilai <i class="bi bi-arrow-right ms-1"></i>
                        </a>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4" class="text-center py-5 text-muted">
                        Tidak ada data mahasiswa ditemukan. Silakan gunakan filter di atas.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
